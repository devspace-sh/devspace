---
title: Deploy Helm Charts
sidebar_label: helm
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FragmentInfoComponentChart from '../../../_partials/info-component-chart.mdx';

To deploy Helm charts, you need to configure them within the `deployments` section of the `devspace.yaml`.

## Examples

<Tabs
  defaultValue="component"
  values={[
    { label: 'Component Chart', value: 'component', },
    { label: 'Custom Chart', value: 'remote', },
    { label: 'Local Chart', value: 'local', },
    { label: 'Git Chart Repo', value: 'git', },
  ]
}>
<TabItem value="component">

```yaml
deployments:
  backend:
    helm:
      values:
        containers:
        - image: reg.tld/username/devspace
        service:
          ports:
          - port: 3000
```

<FragmentInfoComponentChart/>

</TabItem>
<TabItem value="remote">

```yaml {4-6}
deployments:
  backend:
    helm:
      chart:
        name: chart-name
        repo: https://my-charts.company.tld/
      values:
        # If registry.url/repo/image was found under images as well, will be
        # rewritten to registry.url/repo/image:generated_tag
        imageWithTag: registry.url/repo/image
        # If registry.url/repo/image was found under images.app as well, will be
        # rewritten to registry.url/repo/image
        imageWithoutTag: ${runtime.images.app.image}
        # If registry.url/repo/image was found under images.app as well, will be
        # rewritten to generated_tag
        onlyTag: ${runtime.images.app.tag}
```

</TabItem>
<TabItem value="local">

```yaml {5}
deployments:
  backend:
    helm:
      chart:
        name: ./path/to/chart
      values:
        # If registry.url/repo/image was found under images as well, will be
        # rewritten to registry.url/repo/image:generated_tag
        imageWithTag: registry.url/repo/image
        # If registry.url/repo/image was found under images.app as well, will be
        # rewritten to registry.url/repo/image
        imageWithoutTag: ${runtime.images.app.image}
        # If registry.url/repo/image was found under images.app as well, will be
        # rewritten to generated_tag
        onlyTag: ${runtime.images.app.tag}
```

</TabItem>

<TabItem value="git">

```yaml {5}
deployments:
  backend:
    helm:
      chart:
        git: https://github.com/<username>/<chartrepo>.git
        # optional git configs
        branch: branchName
        tag: tag
        revision: revision
        subPath: subpath/chartdir
```

</TabItem>
</Tabs>

## General Options

### `name`
The `name` option is optional and expects a string with the name of the release used to deploy this Helm chart. By default, DevSpace will use the deployment key for the release name, but `name` can be used to override it.

#### Example: Deployment Name
```yaml {3}
deployments:
  database:
    name: custom-database-name # database by default
    helm:
      chart:
        name: bitnami/mysql
```

### `namespace`
The `namespace` option is optional and expects a string with the namespace used to deploy the Helm chart to.

:::warning
Only use this option if you really need to. Hard-coding the namespace in `devspace.yaml` makes it harder to share the configuration with your colleagues. It is recommended to set the default namespace of the current context instead using:
```bash
devspace use namespace [some-namespace]
```
:::

#### Example: Deployment Namespace
```yaml {3}
deployments:
  database:
    namespace: some-namespace
    helm:
      chart:
        name: bitnami/mysql
```

### `updateImageTags`
The `updateImageTags` option expects a boolean stating if DevSpace should do [Image Tag Replacement](../basics.mdx#3-tag-replacement).

When set to `true`, DevSpace searches all your values (specified via `values` or `valuesFiles`) for images that are defined in the `images` section of the `devspace.yaml`. If DevSpace finds an image, it replaces or appends the image tag with the tag it created during the image building process. Image tag replacement makes sure that your application will always be started with the most up-to-date image that DevSpace has built for you.

DevSpace will replace the following things:
- **registry.url/repo/name** that corresponds to a `images.*.image`, will be rewritten to `registry.url/repo/name:generated_tag`

:::info In-Memory Tag Replacement
Tag replacement takes place **in-memory** and is **not** writing anything to the filesystem, i.e. it will **never** change any of your configuration files.
:::

#### Default Value for `updateImageTags`
```yaml
updateImageTags: false
```

#### Example: Enable Tag Replacement
```yaml {3}
deployments:
  database:
    updateImageTags: true
    helm:
      chart:
        name: bitnami/mysql
```

## Chart

### Component Chart
When `values` without `chart` configuration is given, DevSpace will default to using the [Component Chart](https://devspace.sh/component-chart/docs/introduction).

<FragmentInfoComponentChart/>

#### Example: Component Chart Deployment
```yaml
deployments:
  backend:
    helm:
      # Devspace uses the component-chart by default
      # chart:
      #   name: component-chart
      #   repo: https://charts.devspace.sh
      #   version: 0.8.4
      values:
        containers:
        - image: reg.tld/username/devspace
        service:
          ports:
          - port: 3000
```

### `chart.name`
The `name` option is mandatory and expects a string stating either:
- **a path to a local chart** that is stored on the filesystem
- **or the name of a remote chart** that is stored in a repository (one specified via [`repo` option](#chartrepo)) or in the form of `repo/name`, where `repo` was added via `helm repo add repo https://repo.url` beforehand

DevSpace follows the same behavior as `helm install` and first checks if the path specified in `name` exists on the file system and is a valid chart. If not, DevSpace will assume that the `name` is not a path but the name of a remote chart located in a chart repository.

#### Example: Simple Helm Deployment
```yaml {5}
deployments:
  database:
    helm:
      chart:
        name: bitnami/mysql
```
**Explanation:**
Deploying the above example would roughly be equivalent to this command:
```bash
helm install database bitnami/mysql
```

### `chart.version`
The `version` option expects a string stating the version of the chart that should be used.

#### Default Value for `version`
```yaml
version: ""
```

:::note Latest Version
If no version is specified, Helm will by default use the latest version of the chart.
:::

#### Example: Custom Chart Version
```yaml {6}
deployments:
  database:
    helm:
      chart:
        name: bitnami/mysql
        version: "1.3.1"
```
**Explanation:**
Deploying the above example would roughly be equivalent to this command:
```bash
helm install database bitnami/mysql --version="1.3.1"
```

### `chart.repo`
The `repo` option expects a string with a URL to a [Helm Chart Repository](https://helm.sh/docs/chart_repository/). This is equivalent of using the `--repo` flag in `helm install`

#### Example: Custom Chart Repository
```yaml {6}
deployments:
  database:
    helm:
      chart:
        name: custom-chart
        repo: https://my-repo.tld/
```
**Explanation:**
Deploying the above example would roughly be equivalent to this command:
```bash
helm install database custom-chart --repo "https://my-repo.tld/"
```

### `chart.username`
The `username` option expects a string that specifies the user that should be used to access `chart.repo`. Will be used as value for the helm flag `--username`

### `chart.password`
The `password` option expects a string that specifies the password that should be used to access `chart.repo`. Will be used as value for the helm flag `--password`

## Values
Helm charts can be configured by overriding the default values of the chart.

### `values`
The `values` option expects an object with values that should be overriding the default values of this Helm chart.

Compared to the `valuesFiles` option, using `values` has the following advantages:
- It is easier to comprehend and faster to find (no references)
- It allows you to use [dynamic config variables](../../variables/basics.mdx)

:::info
Because both, `values` and `valuesFiles`, have advantages and disadvantages, it is often useful to combine them. When setting both, values defined in `values` have precedence over values defined in `valuesFiles`.
:::

#### Default Value for `values`
```yaml
values: {}
```

#### Example: Using Values in devspace.yaml
```yaml {6-9}
deployments:
  database:
    helm:
      chart:
        name: bitnami/mysql
      values:
        mysqlRootPassword: ${MYSQL_ROOT_PASSWORD}
        mysqlUser: db_user
        mysqlDatabase: app_database
```
**Explanation:**
Deploying the above example would roughly be equivalent to this command:
```bash
helm install database bitnami/mysql --set mysqlRootPassword="$MYSQL_ROOT_PASSWORD" --set mysqlUser="db_user" --set mysqlDatabase="app_database"
```

### `valuesFiles`
The `valuesFiles` option expects an array of paths to yaml files which specify values for overriding the values.yaml of the Helm chart.

Compared to the `values` option, using `valuesFiles` has the following advantages:
- It reduces the size of your `devspace.yaml` especially when setting many values for a chart
- It allows you to run Helm commands directly without DevSpace, e.g. `helm upgrade [NAME] -f mysql/values.yaml`

:::info
Because both, `values` and `valuesFiles`, have advantages and disadvantages, it is often useful to combine them. When setting both, values defined in `values` have precedence over values defined in `valuesFiles`.
:::

#### Default Value for `valuesFiles`
```yaml
valuesFiles: []
```

#### Example: Using Values Files
```yaml {6-8  }
deployments:
  database:
    helm:
      chart:
        name: bitnami/mysql
      valuesFiles:
      - mysql/values.yaml
      - mysql/values.production.yaml
```
**Explanation:**
Deploying the above example would roughly be equivalent to this command:
```bash
helm install database bitnami/mysql -f mysql/values.yaml -f mysql/values.production.yaml
```

## Helm Options

### `displayOutput`

The `displayOutput` option expects a boolean and allows helm output to be printed to the console after `helm install` and `helm upgrade`. This can be used to display `notes.txt` from your helm charts.

#### Default Value for `displayOutput`
```yaml
displayOutput: false
```

#### Example: displayOutput
```yaml {4}
deployments:
  database:
    helm:
      displayOutput: true
      chart:
        name: bitnami/mysql
```

**Explanation:**
Deploying the above example would print the helm output and the `notes.txt` from the bitnami/mysql chart.

### `templateArgs`
The `templateArgs` specifies an array of arguments that will be passed by devspace additionally to the standard arguments to `helm template` during `devspace render`.

### `upgradeArgs`
The `upgradeArgs` specifies an array of arguments that will be passed by devspace additionally to the standard arguments to `helm upgrade` during deployment.

### `fetchArgs`
The `fetchArgs` specifies an array of arguments that will be passed by devspace additionally to the standard arguments to `helm fetch` during deployment.
